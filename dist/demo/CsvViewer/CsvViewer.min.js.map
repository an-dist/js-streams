{
  "version": 3,
  "sources": ["CsvViewer.ts"],
  "sourcesContent": ["// @ts-ignore\nimport * as streams from \"/web.ts\"\n\nglobalThis.console = new streams.DomConsole(\"console\", globalThis.console)\n\nconst rdoInputFormatTSV = document.getElementById(\"rdoInputFormatTSV\") as HTMLInputElement\nconst txtFile = document.getElementById(\"txtFile\") as HTMLInputElement\nconst tblResult = document.getElementById(\"tblResult\") as HTMLTableElement\n\nlet controller: AbortController | undefined\n\ntxtFile.onchange = async () => {\n  if (!controller || !controller.signal.aborted) {\n    controller?.abort()\n    controller = new AbortController()\n  }\n\n  tblResult.innerHTML = \"\"\n  tblResult.createTBody()\n\n  if (!txtFile.files || txtFile.files.length === 0) {\n    return\n  }\n\n  const source = txtFile.files[0].stream()\n    .pipeThrough(new streams.Utf8DecoderStream(), { signal: controller.signal })\n    .pipeThrough(new streams.CsvDeserializer({\n      hasHeader: true,\n      delimitor: rdoInputFormatTSV.checked ? \"\\t\" : \",\",\n    }).transformable(), { signal: controller.signal })\n\n  let no = 1\n  for await (const obj of streams.toAsyncIterableIterator(source, { signal: controller.signal })) {\n    if (!tblResult.tHead) {\n      const head = tblResult.createTHead()\n      const row = head.insertRow()\n      let th = document.createElement(\"th\")\n      th.textContent = \"#\"\n      row.append(th)\n      for (const key in obj) {\n        th = document.createElement(\"th\")\n        th.textContent = key\n        row.append(th)\n      }\n    }\n    const row = tblResult.tBodies[0].insertRow()\n    row.insertCell().textContent = (no++).toLocaleString()\n    for (const value of Object.values(obj)) {\n      row.insertCell().textContent = value?.toString() ?? \"\"\n      await streams.sleep(0)\n    }\n  }\n}"],
  "mappings": "AACA,UAAYA,MAAa,UAEzB,WAAW,QAAU,IAAIA,EAAQ,WAAW,UAAW,WAAW,OAAO,EAEzE,MAAMC,EAAoB,SAAS,eAAe,mBAAmB,EAC/DC,EAAU,SAAS,eAAe,SAAS,EAC3CC,EAAY,SAAS,eAAe,WAAW,EAErD,IAAIC,EAEJF,EAAQ,SAAW,SAAY,CAS7B,IARI,CAACE,GAAc,CAACA,EAAW,OAAO,WACpCA,GAAY,MAAM,EAClBA,EAAa,IAAI,iBAGnBD,EAAU,UAAY,GACtBA,EAAU,YAAY,EAElB,CAACD,EAAQ,OAASA,EAAQ,MAAM,SAAW,EAC7C,OAGF,MAAMG,EAASH,EAAQ,MAAM,CAAC,EAAE,OAAO,EACpC,YAAY,IAAIF,EAAQ,kBAAqB,CAAE,OAAQI,EAAW,MAAO,CAAC,EAC1E,YAAY,IAAIJ,EAAQ,gBAAgB,CACvC,UAAW,GACX,UAAWC,EAAkB,QAAU,IAAO,GAChD,CAAC,EAAE,cAAc,EAAG,CAAE,OAAQG,EAAW,MAAO,CAAC,EAEnD,IAAIE,EAAK,EACT,gBAAiBC,KAAOP,EAAQ,wBAAwBK,EAAQ,CAAE,OAAQD,EAAW,MAAO,CAAC,EAAG,CAC9F,GAAI,CAACD,EAAU,MAAO,CAEpB,MAAMK,EADOL,EAAU,YAAY,EAClB,UAAU,EAC3B,IAAIM,EAAK,SAAS,cAAc,IAAI,EACpCA,EAAG,YAAc,IACjBD,EAAI,OAAOC,CAAE,EACb,UAAWC,KAAOH,EAChBE,EAAK,SAAS,cAAc,IAAI,EAChCA,EAAG,YAAcC,EACjBF,EAAI,OAAOC,CAAE,CAEjB,CACA,MAAMD,EAAML,EAAU,QAAQ,CAAC,EAAE,UAAU,EAC3CK,EAAI,WAAW,EAAE,aAAeF,KAAM,eAAe,EACrD,UAAWK,KAAS,OAAO,OAAOJ,CAAG,EACnCC,EAAI,WAAW,EAAE,YAAcG,GAAO,SAAS,GAAK,GACpD,MAAMX,EAAQ,MAAM,CAAC,CAEzB,CACF",
  "names": ["streams", "rdoInputFormatTSV", "txtFile", "tblResult", "controller", "source", "no", "obj", "row", "th", "key", "value"]
}
