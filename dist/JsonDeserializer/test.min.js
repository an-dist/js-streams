import{JsonDeserializer as u}from"./JsonDeserializer.min.js";import{sleep as r}from"../funcs/sleep/sleep.min.js";const t=e=>new ReadableStream({start(o){o.enqueue(e),o.close()}}),s=()=>new WritableStream({write(e){console.log(e)}}),i=()=>new WritableStream,c=async e=>{performance.clearMarks("start"),performance.clearMarks("end"),performance.clearMeasures("perf"),performance.mark("start"),await e(),performance.mark("end"),performance.measure("perf","start","end");const o=performance.getEntriesByName("perf")[0];console.log(o.duration)},a=async e=>new u(e).transform(),l=`[	\r
{"a":1,"b":2}	,\r
{"a":3,"b":4},{"a":5,"b":6}	,\r
]`,g=`{"a":1,"b":2}
{"a":3	,"b":4}\r
{"a":5,"b":6}`,m=`[	\r
{"a":1,"b":2/* test */}	,\r
{"a":3,"b":4}, // test
{"a":5,"b":6}	,\r
]`,w=e=>{const o=[];for(let n=0;n<e;++n)o.push('{"a":1,"b":2}');return"["+o.join(",")+"]"},h=e=>{const o=[];for(let n=0;n<e;++n)o.push('{"a":1,"b":2}');return o.join(`
`)},d=e=>{const o=[];for(let n=0;n<e;++n)o.push(`{"a":1/* test */,"b":2} // test
    `);return"["+o.join(",")+"]"},b=async()=>{console.group("JSON"),await t(l).pipeThrough(await a(void 0)).pipeTo(s()),console.groupEnd(),console.group("JSON Lines"),await t(g).pipeThrough(await a({lineSeparated:!0})).pipeTo(s()),console.groupEnd(),console.group("JSON with comments"),await t(m).pipeThrough(await a({withComments:!0})).pipeTo(s()),console.groupEnd(),await r(0),console.group("Performance test");{console.log("count",1e5);const o=w(1e5),n=h(1e5),p=d(1e5);console.group("JSON"),await c(async()=>{await t(o).pipeThrough(await a(void 0)).pipeTo(i())}),console.groupEnd(),await r(0),console.group("JSON Lines"),await c(async()=>{await t(n).pipeThrough(await a({lineSeparated:!0})).pipeTo(i())}),console.groupEnd(),await r(0),console.group("JSON with comments"),await c(async()=>{await t(p).pipeThrough(await a({withComments:!0})).pipeTo(i())}),console.groupEnd()}console.groupEnd(),await r(0)};console.group("JsonDeserializer"),await b(),console.groupEnd(),console.log("Test completed.");
//# sourceMappingURL=test.min.js.map
